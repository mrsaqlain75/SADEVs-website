<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign In </title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css" integrity="sha512-SnH5WK+bZxgPHs44uWIX+LLJAJ9/2PkPKZ5QiAj6Ta86w+fsb2TkcmfRyVX3pBnMFcV7oQPJkl9QevSCWr3W6A==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="index-styles.css">
    <link rel="stylesheet" href="signup.css">
</head>
<body>
    <div class="pre-header">
        <p>This website is under-development. Please support us with you precious <a href="">DONATIONS</a></p>
    </div>
    <header>
        <a href="index.html"><img src="Images/sadevs-logo.png" alt="company-logo"></a>
        <div class="menu-btn">
            <i id="hamburger" class="fas fa-bars"></i>
        </div>
        <ul class="menu">
            <li><a href="#">Home</a></li>
            <li><a href="#">Latest</a></li>
            <li><a href="#">Popular</a></li>
            <li class="dropdown">
                <a href="#">Categories</a>
                <ul class="dropdown-content">
                    <li><a href="#">IT & Tech</a></li>
                    <li><a href="#">News</a></li>
                    <li><a href="#">Earning Techniques</a></li>
                </ul>
            </li>
            <li><a href="#">Write & Earn</a></li>
            <li><a href="#">Online Courses</a></li>
            <li><a href="#">Contact</a></li>
            <li><a href="#">About</a></li>
            <li class="focus"><a style="background-color: #00abe4;" href="signin.html">Sign In</a></li>
            <li><a href="signup.html">Sign Up</a></li>
        </ul>
    </header>
    <div class="wrapper">
        <h2>Sign In</h2>
        <form id = "login_form">
          <div class="input-box">
            <input type="text" id="email" placeholder="Enter your email" required>
          </div>
          <div class="input-box">
            <input type="password" id="pass" placeholder="Enter your password" required>
          </div>
          <div class="input-box button">
            <input type="Submit" id="submit_btn" value="Sign In">
          </div>
          <div class="text">
            <h3>Don't have an account? <a href="Signup.html">Signup now</a></h3>
          </div>
        </form>
      </div>
 

      <script>
        document.addEventListener('DOMContentLoaded', function() {
            const menuBtn = document.querySelector('.menu-btn');
            const menu = document.querySelector('.menu');
            
            menuBtn.addEventListener('click', function() {
                menu.classList.toggle('active');
            });
        });
    </script>
    <script>
      document.getElementById("login_form").addEventListener('submit', async function(event){
  event.preventDefault();

  // Getting values from the input boxes
  const email = document.getElementById('email').value;
  const pass = document.getElementById('pass').value;

  try {
    // Sending login request
    const response = await fetch('/login', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ email, pass })
    });

    const result = await response.json();

    if (response.ok) {
      window.alert(result.message);

      // Fetching session data
      const sessionResponse = await fetch('/session-data');
      const sessionResult = await sessionResponse.json();

      if (sessionResponse.ok) {
        // Alerting session data before redirecting
        window.alert(`Session Data: ${JSON.stringify(sessionResult.sessionData)}`);
        // Redirect to the next webpage
        window.location.href = "edit-profile.html";
      } else {
        window.alert(sessionResult.message);
      }
      
    } else {
      window.alert(result.message);
    }
  } catch (error) {
    window.alert("An error occurred");
  }
});

    </script>
</body>
</html>